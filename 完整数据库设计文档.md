# 景区预约管理系统完整数据库设计文档

## 目录
1. [用户管理模块](#用户管理模块)
2. [景区管理模块](#景区管理模块)
3. [预约管理模块](#预约管理模块)
4. [活动管理模块](#活动管理模块)
5. [内容管理模块](#内容管理模块)
6. [互动管理模块](#互动管理模块)
7. [系统管理模块](#系统管理模块)

---

## 用户管理模块

### 用户表（user）
```sql
CREATE TABLE `user` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '用户ID',
  `user_name` varchar(50) NOT NULL COMMENT '用户名',
  `password` varchar(100) NOT NULL COMMENT '密码',
  `real_name` varchar(50) COMMENT '真实姓名',
  `id_type` varchar(20) NOT NULL COMMENT '证件类型',
  `id_number` varchar(50) NOT NULL COMMENT '证件号码',
  `phone` varchar(20) COMMENT '手机号',
  `email` varchar(100) COMMENT '邮箱',
   `avatar_file_id` bigint COMMENT '头像文件ID（关联resource_file）',
  `open_id` varchar(100) COMMENT '微信OpenID',
  `user_type` tinyint NOT NULL DEFAULT 1 COMMENT '用户类型：1-普通用户，2-后台用户',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：1-常规，2-冻结',
  `register_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '注册时间',
  `last_login_time` datetime COMMENT '最后登录时间',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_name` (`user_name`),
  UNIQUE KEY `uk_phone` (`phone`),
  UNIQUE KEY `uk_id_number` (`id_number`),
  UNIQUE KEY `uk_open_id` (`open_id`),
  KEY `idx_user_type` (`user_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
```

### 文件资源表（resource_file）
```sql
CREATE TABLE `resource_file` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `file_name` varchar(255) NOT NULL COMMENT '原始文件名',
  `file_key` varchar(500) NOT NULL COMMENT 'MinIO存储路径',
  `bucket_name` varchar(50) NOT NULL COMMENT '存储桶名称',
  `file_size` bigint COMMENT '文件大小(字节)',
  `mime_type` varchar(100) COMMENT '文件类型',
  `file_type` tinyint NOT NULL COMMENT '1-图片 2-视频 3-文档 4-其他',
  `width` smallint COMMENT '图片/视频宽度',
  `height` smallint COMMENT '图片/视频高度',
  `duration` int COMMENT '视频/音频时长(秒)',
  `sha256` char(64) COMMENT '文件哈希值',
  `upload_user_id` bigint COMMENT '上传用户ID',
  `is_temp` tinyint DEFAULT 0 COMMENT '是否临时文件',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_file_key` (`bucket_name`, `file_key`),
  KEY `idx_upload_user` (`upload_user_id`),
  KEY `idx_file_type` (`file_type`)
) ENGINE=InnoDB COMMENT='统一文件存储表';
```

### 操作员表（operator）
```sql
CREATE TABLE `operator` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '操作员ID',
  `user_id` bigint NOT NULL COMMENT '关联用户ID',
  `username` varchar(50) NOT NULL COMMENT '用户名',
  `password` varchar(100) NOT NULL COMMENT '密码',
  `real_name` varchar(50) COMMENT '真实姓名',
  `phone` varchar(20) COMMENT '手机号',
  `email` varchar(100) COMMENT '邮箱',
  `department` varchar(100) COMMENT '所属部门',
  `role` varchar(50) NOT NULL COMMENT '角色：ADMIN-管理员，OPERATOR-操作员',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `last_login_time` datetime COMMENT '最后登录时间',
  `login_count` int NOT NULL DEFAULT 0 COMMENT '登录次数',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`),
  UNIQUE KEY `uk_user_id` (`user_id`),
  KEY `idx_status` (`status`),
  KEY `idx_role` (`role`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='操作员表';
```

### 用户常用预约人表（user_frequent_member）
```sql
CREATE TABLE `user_frequent_member` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '常用预约人ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `name` varchar(50) NOT NULL COMMENT '姓名',
  `id_type` tinyint NOT NULL DEFAULT 1 COMMENT '证件类型：1-身份证，2-护照，3-其他',
  `id_number` varchar(50) NOT NULL COMMENT '证件号码',
  `phone` varchar(20) COMMENT '手机号',
  `gender` tinyint COMMENT '性别：1-男，2-女',
  `email` varchar(100) COMMENT '邮箱',
  `relationship` varchar(50) COMMENT '与用户关系',
  `is_default` tinyint NOT NULL DEFAULT 0 COMMENT '是否为默认预约人：0-否，1-是',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_id_number` (`id_number`),
  KEY `idx_is_default` (`is_default`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户常用预约人表';
```

### 爽约记录表（no_show_record）
```sql
CREATE TABLE `no_show_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `reservation_id` bigint NOT NULL COMMENT '预约ID',
  `reservation_type` tinyint NOT NULL COMMENT '预约类型：1-个人预约，2-团队预约，3-活动预约',
  `reservation_time` datetime NOT NULL COMMENT '预约时间',
  `record_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '记录时间',
  `operator_id` bigint COMMENT '操作人ID',
  `operator_name` varchar(50) COMMENT '操作人姓名',
  `remark` varchar(255) COMMENT '备注',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_reservation_id` (`reservation_id`),
  KEY `idx_reservation_type` (`reservation_type`),
  KEY `idx_record_time` (`record_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='爽约记录表';
```

### 黑名单记录表（blacklist_record）
```sql
CREATE TABLE `blacklist_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `action_type` tinyint NOT NULL COMMENT '操作类型：1-加入黑名单，2-移出黑名单',
  `reason` varchar(255) COMMENT '原因',
  `operator_id` bigint COMMENT '操作人ID',
  `operator_name` varchar(50) COMMENT '操作人姓名',
  `action_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_action_type` (`action_type`),
  KEY `idx_action_time` (`action_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='黑名单记录表';
```

### 权限表（permission）
```sql
CREATE TABLE `permission` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '权限ID',
  `permission_code` varchar(100) NOT NULL COMMENT '权限编码',
  `permission_name` varchar(100) NOT NULL COMMENT '权限名称',
  `permission_desc` varchar(255) COMMENT '权限描述',
  `resource_type` varchar(50) NOT NULL COMMENT '资源类型：MENU-菜单，BUTTON-按钮，API-接口',
  `resource_path` varchar(255) COMMENT '资源路径',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_permission_code` (`permission_code`),
  KEY `idx_resource_type` (`resource_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='权限表';
```

### 操作员权限表（operator_permission）
```sql
CREATE TABLE `operator_permission` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '关联ID',
  `operator_id` bigint NOT NULL COMMENT '操作员ID',
  `permission_id` bigint NOT NULL COMMENT '权限ID',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_operator_permission` (`operator_id`, `permission_id`),
  KEY `idx_operator_id` (`operator_id`),
  KEY `idx_permission_id` (`permission_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='操作员权限表';
```

### 用户搜索历史表（user_search_history）
```sql
CREATE TABLE user_search_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '历史ID',
    user_id BIGINT NOT NULL COMMENT '用户ID',
    keyword VARCHAR(100) NOT NULL COMMENT '搜索关键词',
    search_count INT DEFAULT 1 COMMENT '搜索次数',
    last_search_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '最后搜索时间',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_user_id (user_id),
    INDEX idx_keyword (keyword),
    INDEX idx_last_search_time (last_search_time),
    UNIQUE KEY uk_user_keyword (user_id, keyword)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户搜索历史表';
```

---

## 景区管理模块

### 景区表（scenic_area）
```sql
CREATE TABLE `scenic_area` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '景区ID',
  `name` varchar(100) NOT NULL COMMENT '景区名称',
  `description` text COMMENT '景区描述',
  `address` varchar(255) COMMENT '景区地址',
   `cover_file_id` bigint COMMENT '封面图文件ID（关联resource_file）',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-关闭，1-开放',
  `daily_limit` int DEFAULT 0 COMMENT '每日预约人数上限',
  `time_slot_limit` int DEFAULT 0 COMMENT '每个时间段预约人数上限',
  `advance_days` int DEFAULT 7 COMMENT '可提前预约天数',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_name` (`name`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='景区信息表';
```

### 时间段表（time_slot）
```sql
CREATE TABLE `time_slot` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '时间段ID',
  `scenic_id` bigint NOT NULL COMMENT '关联景区ID',
  `slot_name` varchar(50) NOT NULL COMMENT '时间段名称，如：上午、下午',
  `description` varchar(255) COMMENT '时间段描述',
  `start_time` time NOT NULL COMMENT '开始时间',
  `end_time` time NOT NULL COMMENT '结束时间',
  `slot_limit` int NOT NULL DEFAULT 0 COMMENT '时间段容量上限',
  `week_limit` int NOT NULL DEFAULT 0 COMMENT '每周预约人数上限',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-关闭，1-开放',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_scenic_id` (`scenic_id`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='预约时间段表';
```

### 日期时间段剩余名额表（date_time_slot_remaining）
```sql
CREATE TABLE `date_time_slot_remaining` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `date` date NOT NULL COMMENT '日期',
  `scenic_id` bigint NOT NULL COMMENT '景区ID',
  `time_slot_id` bigint NOT NULL COMMENT '时间段ID',
  `slot_limit` int NOT NULL COMMENT '容量上限',
  `booked_count` int NOT NULL DEFAULT 0 COMMENT '已预约人数',
  `remaining_count` int NOT NULL COMMENT '剩余名额',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_date_slot` (`date`, `time_slot_id`),
  KEY `idx_date_scenic` (`date`, `scenic_id`),
  KEY `idx_time_slot_id` (`time_slot_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='日期时间段剩余名额表';
```

### 日期配置表（date_config）
```sql
CREATE TABLE `date_config` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '配置ID',
  `scenic_id` bigint NOT NULL COMMENT '景区ID',
  `config_date` date NOT NULL COMMENT '配置日期',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-不可预约，1-可预约',
  `open_status` tinyint NOT NULL DEFAULT 1 COMMENT '开放状态：0-关闭，1-开放',
  `open_time` time COMMENT '开放时间',
  `close_time` time COMMENT '关闭时间',
  `daily_limit` int DEFAULT 0 COMMENT '当日预约人数上限，覆盖景区默认设置',
  `remark` varchar(255) COMMENT '备注',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_scenic_date` (`scenic_id`, `config_date`),
  KEY `idx_config_date` (`config_date`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='日期配置表';
```

### 地图标注表（map_marker）
```sql
CREATE TABLE `map_marker` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '标注ID',
  `scenic_id` bigint NOT NULL COMMENT '景区ID',
  `marker_name` varchar(100) NOT NULL COMMENT '标注名称',
  `marker_type` tinyint NOT NULL COMMENT '标注类型：1-景点，2-设施，3-入口，4-出口，5-厕所，6-餐饮，7-其他',
  `latitude` decimal(10,7) NOT NULL COMMENT '纬度',
  `longitude` decimal(10,7) NOT NULL COMMENT '经度',
   `icon_file_id` bigint COMMENT '图标文件ID',
  `description` text COMMENT '描述',
  `image_file_id` bigint COMMENT '图片文件ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
 `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  KEY `idx_scenic_id` (`scenic_id`),
  KEY `idx_marker_type` (`marker_type`),
  KEY `idx_status` (`status`),
  KEY `idx_sort_order` (`sort_order`),
  KEY `idx_icon_file` (`icon_file_id`),
  KEY `idx_image_file` (`image_file_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='地图标注表';
```

### 参观路线表（visit_route）
```sql
CREATE TABLE `visit_route` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '路线ID',
  `name` varchar(100) NOT NULL COMMENT '路线名称',
  `route_type` varchar(50) NOT NULL COMMENT '路线类型：RECOMMEND-推荐路线，THEME-主题路线，CUSTOM-自定义路线',
  `description` text COMMENT '路线描述',
  `estimated_duration` int COMMENT '预计时长(分钟)',
  `route_length` decimal(10,2) COMMENT '路线长度(米)',
 `map_file_id` bigint COMMENT '路线图文件ID',
  `cover_file_id` bigint COMMENT '封面图文件ID',
  `start_marker_id` bigint COMMENT '起点标注ID',
  `end_marker_id` bigint COMMENT '终点标注ID',
  `scenic_id` bigint COMMENT '关联景区ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `view_count` int NOT NULL DEFAULT 0 COMMENT '查看次数',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_scenic_id` (`scenic_id`),
  KEY `idx_route_type` (`route_type`),
  KEY `idx_sort_order` (`sort_order`),
  KEY `idx_status` (`status`),
 KEY `idx_map_file` (`map_file_id`),
  KEY `idx_cover_file` (`cover_file_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='参观路线表';
```

### 路线标注关联表（route_marker）
```sql
CREATE TABLE `route_marker` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '关联ID',
  `route_id` bigint NOT NULL COMMENT '路线ID',
  `marker_id` bigint NOT NULL COMMENT '标注ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_route_marker` (`route_id`, `marker_id`),
  KEY `idx_route_id` (`route_id`),
  KEY `idx_marker_id` (`marker_id`),
  KEY `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='路线标注关联表';
```

### 路线坐标点表（route_point）
```sql
CREATE TABLE `route_point` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '坐标点ID',
  `route_id` bigint NOT NULL COMMENT '路线ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_route_id` (`route_id`),
  KEY `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='路线坐标点表';
```

---

## 预约管理模块

### 个人预约表（individual_reservation）
```sql
CREATE TABLE `individual_reservation` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '预约ID',
  `reservation_no` varchar(32) NOT NULL COMMENT '预约编号',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `scenic_id` bigint NOT NULL COMMENT '景区ID',
  `visit_date` date NOT NULL COMMENT '入区日期',
  `time_slot_id` bigint NOT NULL COMMENT '入区时间段ID',
  `adult_count` int NOT NULL DEFAULT 0 COMMENT '成人数量',
  `child_count` int NOT NULL DEFAULT 0 COMMENT '未成年人数量',
  `total_count` int NOT NULL DEFAULT 0 COMMENT '总人数',
  `status` tinyint NOT NULL DEFAULT 0 COMMENT '订单状态：0-未开始，1-已取消，10-已核销，11-已过期',
  
  /* 电子票相关字段 */
  `qr_code` varchar(255) COMMENT '二维码内容/URL',
 `qr_code_file_id` bigint COMMENT '二维码文件ID（关联resource_file）',
  `qr_code_content` text COMMENT '二维码内容',
  `valid_from` datetime COMMENT '电子票生效时间',
  `valid_until` datetime COMMENT '电子票失效时间',
  `ticket_status` tinyint DEFAULT 0 COMMENT '电子票状态：0-未生成，1-已生成，2-已失效',
  `ticket_generate_time` datetime COMMENT '电子票生成时间',
  
  /* 验证相关字段 */
  `verification_status` tinyint DEFAULT 0 COMMENT '验证状态：0-未验证，2-已验证，3-已过期',
  `verification_time` datetime COMMENT '验证时间',
  `verification_type` tinyint COMMENT '验证类型：1-扫码验证，2-人工验证',
  `operator_id` bigint COMMENT '操作员ID',
  `verification_location` varchar(100) COMMENT '验证地点',
  `device_info` varchar(255) COMMENT '设备信息',
  `verification_remark` varchar(255) COMMENT '验证备注',
  
  /* 取消相关字段 */
  `cancel_time` datetime COMMENT '取消时间',
  `cancel_reason` varchar(255) COMMENT '取消原因',
  
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_reservation_no` (`reservation_no`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_scenic_id` (`scenic_id`),
  KEY `idx_visit_date` (`visit_date`),
  KEY `idx_time_slot_id` (`time_slot_id`),
  KEY `idx_status` (`status`),
  KEY `idx_verification_time` (`verification_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='个人预约表';
```

### 团队预约表格模板表（team_appointment_template）
```sql
CREATE TABLE team_appointment_template (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '模板ID',
    template_name VARCHAR(255) NOT NULL COMMENT '模板名称',
    template_file_id BIGINT NOT NULL COMMENT '模板文件ID（关联resource_file表）',
    description VARCHAR(500) COMMENT '模板描述',
    is_default TINYINT(1) DEFAULT 0 COMMENT '是否默认模板：0-否，1-是',
    enabled TINYINT(1) DEFAULT 1 COMMENT '是否启用：0-禁用，1-启用',
   `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_is_default (is_default),
    INDEX idx_enabled (enabled)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='团队预约表格模板表';
```

### 团队预约表（team_appointment）
```sql
CREATE TABLE team_appointment (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '预约ID',
    appointment_no VARCHAR(50) NOT NULL COMMENT '预约编号',
    user_id BIGINT NOT NULL COMMENT '用户ID',
    appointment_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '预约时间',
    form_file_id BIGINT NOT NULL COMMENT '填写后的表格文件ID（关联resource_file表）',
    team_name VARCHAR(100) COMMENT '团队名称（从表格中提取）',
    team_leader VARCHAR(50) COMMENT '团队负责人（从表格中提取）',
    contact_phone VARCHAR(20) COMMENT '联系电话（从表格中提取）',
    team_size INT COMMENT '团队人数（从表格中提取）',
    status TINYINT DEFAULT 1 COMMENT '预约状态：0-已取消，1-未开始，2-已完成',
    contact_email VARCHAR(100) COMMENT '联系人邮箱',
    remarks VARCHAR(500) COMMENT '备注',
    admin_remarks VARCHAR(500) COMMENT '管理员备注',
    check_in_time DATETIME COMMENT '签到时间',
   `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    UNIQUE KEY uk_appointment_no (appointment_no),
    INDEX idx_user_id (user_id),
    INDEX idx_status (status),
    INDEX idx_appointment_time (appointment_time),
    INDEX idx_team_name (team_name),
    INDEX idx_team_leader (team_leader),
    INDEX idx_contact_phone (contact_phone)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='团队预约表';
```

### 预约规则表（reservation_rule）
```sql
CREATE TABLE `reservation_rule` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '规则ID',
  `scenic_id` bigint NOT NULL COMMENT '景区ID',
  `advance_hours` int NOT NULL DEFAULT 2 COMMENT '预约提前时间(小时)',
  `daily_reservation_limit` int NOT NULL DEFAULT 1 COMMENT '单日预约上限',
  `time_slot_limit` int NOT NULL DEFAULT 100 COMMENT '同时段预约人数',
  `allow_cancellation` tinyint NOT NULL DEFAULT 1 COMMENT '是否允许取消：0-不允许，1-允许',
  `cancellation_deadline` int NOT NULL DEFAULT 24 COMMENT '取消截止时间(小时前)',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_scenic_id` (`scenic_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='预约规则表';
```

### 预约人员表（reservation_person）
```sql
CREATE TABLE `reservation_person` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '预约人ID',
  `reservation_id` bigint NOT NULL COMMENT '关联预约ID',
  `reservation_type` tinyint NOT NULL COMMENT '预约类型：1-个人预约，2-团队预约，3-活动预约',
  `name` varchar(50) NOT NULL COMMENT '姓名',
  `id_type` tinyint NOT NULL DEFAULT 1 COMMENT '证件类型：1-身份证，2-护照，3-其他',
  `id_number` varchar(50) NOT NULL COMMENT '证件号码',
  `phone` varchar(20) COMMENT '手机号',
  `person_type` tinyint NOT NULL DEFAULT 1 COMMENT '人员类型：1-成人，2-未成年人',
  `is_contact` tinyint NOT NULL DEFAULT 0 COMMENT '是否为联系人：0-否，1-是（个人预约使用）',
  `is_leader` tinyint NOT NULL DEFAULT 0 COMMENT '是否为团队负责人：0-否，1-是（团队预约使用）',
  `status` tinyint NOT NULL DEFAULT 0 COMMENT '状态：0-未验证，1-已验证',
  `verification_time` datetime COMMENT '验证时间',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_reservation_id` (`reservation_id`),
  KEY `idx_reservation_type` (`reservation_type`),
  KEY `idx_id_number` (`id_number`),
  KEY `idx_status` (`status`),
  KEY `idx_is_contact` (`is_contact`),
  KEY `idx_is_leader` (`is_leader`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='预约人员表';
```

---

## 活动管理模块

### 活动表（activity）
```sql
CREATE TABLE activity (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '活动ID',
    title VARCHAR(255) NOT NULL COMMENT '活动标题',
    summary VARCHAR(500) COMMENT '活动摘要',
    content_type TINYINT DEFAULT 1 COMMENT '内容类型：1-纯文本，2-Markdown',
    content TEXT COMMENT '活动详细内容（纯文本或Markdown格式）',
    content_file_id BIGINT COMMENT 'Markdown文件ID（关联resource_file表）',
    start_time DATETIME NOT NULL COMMENT '活动开始时间',
    end_time DATETIME NOT NULL COMMENT '活动结束时间',
    location VARCHAR(255) COMMENT '活动地点',
    location_detail VARCHAR(500) COMMENT '活动地点详情',
    min_participants INT DEFAULT 1 COMMENT '最少参与人数',
    max_participants INT COMMENT '最大参与人数',
    current_participants INT DEFAULT 0 COMMENT '当前参与人数',
    age_requirement VARCHAR(255) COMMENT '年龄要求（如：10岁及以上）',
    registration_deadline DATETIME COMMENT '报名截止时间',
    cover_image_id BIGINT COMMENT '封面图片ID（高清）',
    cover_thumbnail_id BIGINT COMMENT '封面缩略图ID（用于列表页面）',
    status TINYINT DEFAULT 1 COMMENT '活动状态：0-已取消，1-未开始，2-进行中，3-已结束',
    price INT DEFAULT 0 COMMENT '票价',
    is_free TINYINT(1) DEFAULT 1 COMMENT '是否免费：0-收费，1-免费（默认免费）',
    view_count INT DEFAULT 0 COMMENT '浏览次数',
    enabled TINYINT(1) DEFAULT 1 COMMENT '是否启用：0-禁用，1-启用',
    sort_order INT DEFAULT 0 COMMENT '排序顺序',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_start_time (start_time),
    INDEX idx_end_time (end_time),
    INDEX idx_status (status),
    INDEX idx_is_free (is_free),
    INDEX idx_enabled (enabled)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='活动表';
```



### 活动预约表格模板表
```sql
CREATE TABLE activity_registration_template (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '模板ID',
    activity_id BIGINT NOT NULL COMMENT '活动ID',
    template_name VARCHAR(255) NOT NULL COMMENT '模板名称',
    template_file_id BIGINT NOT NULL COMMENT '模板文件ID（关联resource_file表）',
    description VARCHAR(500) COMMENT '模板描述',
    is_default TINYINT(1) DEFAULT 0 COMMENT '是否默认模板：0-否，1-是',
    enabled TINYINT(1) DEFAULT 1 COMMENT '是否启用：0-禁用，1-启用',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_activity_id (activity_id),
    INDEX idx_is_default (is_default),
    INDEX idx_enabled (enabled)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='活动预约表格模板表';
```

### 活动预约表
```sql
CREATE TABLE activity_registration (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '预约ID',
    registration_no VARCHAR(50) NOT NULL COMMENT '预约编号',
    activity_id BIGINT NOT NULL COMMENT '活动ID',
    activity_title VARCHAR(255) NOT NULL COMMENT '活动名称',
    user_id BIGINT NOT NULL COMMENT '用户ID',
    registration_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '预约时间',
    form_file_id BIGINT NOT NULL COMMENT '填写后的表格文件ID（关联resource_file表）',
    team_name VARCHAR(100) COMMENT '团队名称（从表格中提取）',
    team_leader VARCHAR(50) COMMENT '团队负责人（从表格中提取）',
    contact_phone VARCHAR(20) COMMENT '联系电话（从表格中提取）',
    team_size INT COMMENT '团队人数（从表格中提取）',
    status TINYINT DEFAULT 1 COMMENT '预约状态：0-已取消，1-未开始，2-已完成',
    contact_email VARCHAR(100) COMMENT '联系人邮箱',
    remarks VARCHAR(500) COMMENT '备注',
    admin_remarks VARCHAR(500) COMMENT '管理员备注',
    check_in_time DATETIME COMMENT '签到时间',
   `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    UNIQUE KEY uk_registration_no (registration_no),
    INDEX idx_activity_id (activity_id),
    INDEX idx_user_id (user_id),
    INDEX idx_status (status),
    INDEX idx_registration_time (registration_time),
    INDEX idx_team_name (team_name),
    INDEX idx_team_leader (team_leader),
    INDEX idx_contact_phone (contact_phone)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='活动预约表';
```

## 保护区相关表

### 保护区大事件表
```sql
CREATE TABLE protected_area_event (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '大事件ID',
    title VARCHAR(255) NOT NULL COMMENT '大事件标题',
    summary VARCHAR(500) COMMENT '大事件摘要',
    content_type TINYINT DEFAULT 1 COMMENT '内容类型：1-纯文本，2-Markdown',
    content TEXT COMMENT '大事件详细内容（纯文本或Markdown格式）',
    content_file_id BIGINT COMMENT 'Markdown文件ID（关联resource_file表）',
    event_date DATE NOT NULL COMMENT '大事件日期',
    event_year INT GENERATED ALWAYS AS (YEAR(event_date)) STORED COMMENT '大事件年份',
    event_month INT GENERATED ALWAYS AS (MONTH(event_date)) STORED COMMENT '大事件月份',
    cover_image_id BIGINT COMMENT '封面图片ID',
    cover_video_id BIGINT COMMENT '封面视频ID',
    view_count INT DEFAULT 0 COMMENT '浏览次数',
    enabled TINYINT(1) DEFAULT 1 COMMENT '是否启用：0-禁用，1-启用',
    sort_order INT DEFAULT 0 COMMENT '排序顺序',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_event_date (event_date),
    INDEX idx_event_year_month (event_year, event_month),
    INDEX idx_enabled (enabled)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='保护区大事件表';
```

### 保护区大事件媒体表
```sql
CREATE TABLE protected_area_event_media (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '媒体ID',
    event_id BIGINT NOT NULL COMMENT '大事件ID',
    file_id BIGINT NOT NULL COMMENT '文件资源ID',
    thumbnail_id BIGINT COMMENT '缩略图文件ID（针对视频）',
    title VARCHAR(255) COMMENT '媒体标题',
    description VARCHAR(500) COMMENT '媒体描述',
    sort_order INT DEFAULT 0 COMMENT '排序顺序',
    is_highlight TINYINT(1) DEFAULT 0 COMMENT '是否为精彩瞬间：0-否，1-是',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_event_id (event_id),
    INDEX idx_file_id (file_id),
    INDEX idx_is_highlight (is_highlight)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='保护区大事件媒体表';
```

### 保护区大事件讲解表
```sql
CREATE TABLE protected_area_event_explanation (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '讲解ID',
    event_id BIGINT NOT NULL COMMENT '大事件ID',
    title VARCHAR(255) NOT NULL COMMENT '讲解标题',
    content TEXT NOT NULL COMMENT '讲解内容',
    author VARCHAR(100) COMMENT '作者',
    image_id BIGINT COMMENT '配图文件ID',
    sort_order INT DEFAULT 0 COMMENT '排序顺序',
   `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_event_id (event_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='保护区大事件讲解表';
```

### 保护区大事件讲解对象表
```sql
CREATE TABLE protected_area_event_explanation_object (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '讲解对象ID',
    explanation_id BIGINT NOT NULL COMMENT '讲解ID',
    object_name VARCHAR(255) NOT NULL COMMENT '对象名称（如：黑嘴天鹅）',
    object_description TEXT COMMENT '对象描述',
    image_id BIGINT COMMENT '对象图片文件ID',
    sort_order INT DEFAULT 0 COMMENT '排序顺序',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_explanation_id (explanation_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='保护区大事件讲解对象表';
```

### 保护区大事件讲解对象音频表
```sql
CREATE TABLE protected_area_event_explanation_audio (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '音频ID',
    object_id BIGINT NOT NULL COMMENT '讲解对象ID',
    language VARCHAR(50) NOT NULL DEFAULT 'zh_CN' COMMENT '语言代码：zh_CN-中文，en_US-英语，ja_JP-日语，ko_KR-韩语等',
    audio_id BIGINT NOT NULL COMMENT '音频文件ID',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
    INDEX idx_object_id (object_id),
    INDEX idx_language (language),
    UNIQUE KEY uk_object_language (object_id, language)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='保护区大事件讲解对象音频表';
```

## 用户搜索历史表

### 用户搜索历史表
```sql
CREATE TABLE user_search_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '历史ID',
    user_id BIGINT NOT NULL COMMENT '用户ID',
    keyword VARCHAR(100) NOT NULL COMMENT '搜索关键词',
    search_count INT DEFAULT 1 COMMENT '搜索次数',
    last_search_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '最后搜索时间',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',    
    INDEX idx_user_id (user_id),
    INDEX idx_keyword (keyword),
    INDEX idx_last_search_time (last_search_time),
    UNIQUE KEY uk_user_keyword (user_id, keyword)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户搜索历史表';
```

## 拍照打卡和用户发表相关表

### 拍照打卡表
```sql
CREATE TABLE `photo_checkin` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '打卡ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `user_name` varchar(100) COMMENT '用户名称',
  `user_avatar` varchar(255) COMMENT '用户头像',
  `title` varchar(100) COMMENT '打卡标题',
  `content` varchar(1000) COMMENT '文字内容',
  `category_id` bigint COMMENT '分类ID',
  `like_count` int NOT NULL DEFAULT 0 COMMENT '点赞数',
  `view_count` int NOT NULL DEFAULT 0 COMMENT '查看数',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-待审核，1-已发布，2-已拒绝，3-已删除',
 `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_category_id` (`category_id`),
  KEY `idx_create_time` (`create_time`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='拍照打卡表';
```

### 打卡照片表
```sql
CREATE TABLE `checkin_photo` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '照片ID',
  `checkin_id` bigint NOT NULL COMMENT '打卡ID',
 `file_id` bigint NOT NULL COMMENT '照片文件ID（关联resource_file）',
  `thumbnail_file_id` bigint COMMENT '缩略图文件ID',
  `width` int COMMENT '照片宽度',
  `height` int COMMENT '照片高度',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
 `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',  
  PRIMARY KEY (`id`),
  KEY `idx_checkin_id` (`checkin_id`),
KEY `idx_file_id` (`file_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='打卡照片表';
```

### 打卡分类表
```sql
CREATE TABLE `checkin_category` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `name` varchar(50) NOT NULL COMMENT '分类名称',
   `icon_file_id` bigint COMMENT '分类图标文件ID',
  `description` varchar(255) COMMENT '分类描述',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_sort_order` (`sort_order`),
  KEY `idx_status` (`status`),
 KEY `idx_icon_file` (`icon_file_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='打卡分类表';
```

### 内容点赞表
```sql
CREATE TABLE `content_like` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '点赞ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `content_id` bigint NOT NULL COMMENT '内容ID',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_content` (`user_id`, `content_id`, `content_type`),
  KEY `idx_content` (`content_id`, `content_type`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_create_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='内容点赞表';
```

## 用户消息相关表

### 用户消息表
```sql
CREATE TABLE `user_message` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '消息ID',
  `user_id` bigint NOT NULL COMMENT '接收用户ID',
  `sender_id` bigint COMMENT '发送者ID，系统消息为NULL',
  `sender_name` varchar(100) COMMENT '发送者名称',
  `sender_avatar` varchar(255) COMMENT '发送者头像',
  `message_type` tinyint NOT NULL COMMENT '消息类型：1-官方消息，2-系统消息，3-点赞通知，4-评论通知，5-入园预约，6-活动预约',
  `title` varchar(200) COMMENT '消息标题',
  `content` text COMMENT '消息内容',
  `related_id` bigint COMMENT '关联ID，如内容ID、预约ID等',
  `related_type` tinyint COMMENT '关联类型：1-内容，2-预约，3-活动，4-其他',
  `is_read` tinyint NOT NULL DEFAULT 0 COMMENT '是否已读：0-未读，1-已读',
 `read_time` datetime COMMENT '阅读时间',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  KEY `idx_user_id` (`user_id`),
  KEY `idx_message_type` (`message_type`),
  KEY `idx_is_read` (`is_read`),
  KEY `idx_create_time` (`create_time`),
  KEY `idx_related` (`related_id`, `related_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户消息表';
```

### 用户收藏表
```sql
CREATE TABLE `user_favorite` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '收藏ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `content_id` bigint NOT NULL COMMENT '内容ID',
  `content_type` tinyint NOT NULL COMMENT '内容类型：1-保护区介绍，2-活动，3-打卡',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',  
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_content` (`user_id`, `content_id`, `content_type`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_content_type` (`content_type`),
  KEY `idx_create_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户收藏表';
```

### 官方消息表
```sql
CREATE TABLE `official_message` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '消息ID',
  `title` varchar(200) NOT NULL COMMENT '消息标题',
  `content` text NOT NULL COMMENT '消息内容',
  `message_type` tinyint NOT NULL DEFAULT 1 COMMENT '消息类型：1-公告，2-通知',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-草稿，1-已发布，2-已下线',
  `publish_time` datetime COMMENT '发布时间',
  `publisher_id` bigint COMMENT '发布人ID',
  `publisher_name` varchar(100) COMMENT '发布人名称',
  `view_count` int NOT NULL DEFAULT 0 COMMENT '查看次数',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_message_type` (`message_type`),
  KEY `idx_status` (`status`),
  KEY `idx_publish_time` (`publish_time`),
  KEY `idx_publisher_id` (`publisher_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='官方消息表';
```

### 用户官方消息关联表
```sql
CREATE TABLE `user_official_message` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '关联ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `message_id` bigint NOT NULL COMMENT '官方消息ID',
  `is_read` tinyint NOT NULL DEFAULT 0 COMMENT '是否已读：0-未读，1-已读',
  `read_time` datetime COMMENT '阅读时间',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_message` (`user_id`, `message_id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_message_id` (`message_id`),
  KEY `idx_is_read` (`is_read`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户官方消息关联表';
```

### 用户常用预约人表
```sql
CREATE TABLE `user_frequent_member` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '常用预约人ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `name` varchar(50) NOT NULL COMMENT '姓名',
  `id_type` tinyint NOT NULL DEFAULT 1 COMMENT '证件类型：1-身份证，2-护照，3-其他',
  `id_number` varchar(50) NOT NULL COMMENT '证件号码',
  `phone` varchar(20) COMMENT '手机号',
  `gender` tinyint COMMENT '性别：1-男，2-女',
  `email` varchar(100) COMMENT '邮箱',
  `relationship` varchar(50) COMMENT '与用户关系',
  `is_default` tinyint NOT NULL DEFAULT 0 COMMENT '是否为默认预约人：0-否，1-是',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_id_number` (`id_number`),
  KEY `idx_is_default` (`is_default`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户常用预约人表';
```

## 参观路线和地图标志相关表

### 地图标注表
```sql
CREATE TABLE `map_marker` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '标注ID',
  `scenic_id` bigint NOT NULL COMMENT '景区ID',
  `marker_name` varchar(100) NOT NULL COMMENT '标注名称',
  `marker_type` tinyint NOT NULL COMMENT '标注类型：1-景点，2-设施，3-入口，4-出口，5-厕所，6-餐饮，7-其他',
  `latitude` decimal(10,7) NOT NULL COMMENT '纬度',
  `longitude` decimal(10,7) NOT NULL COMMENT '经度',
   `icon_file_id` bigint COMMENT '图标文件ID',
  `description` text COMMENT '描述',
  `image_file_id` bigint COMMENT '图片文件ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
 `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  KEY `idx_scenic_id` (`scenic_id`),
  KEY `idx_marker_type` (`marker_type`),
  KEY `idx_status` (`status`),
  KEY `idx_sort_order` (`sort_order`),
  KEY `idx_icon_file` (`icon_file_id`),
  KEY `idx_image_file` (`image_file_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='地图标注表';
```

### 参观路线表
```sql
CREATE TABLE `visit_route` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '路线ID',
  `name` varchar(100) NOT NULL COMMENT '路线名称',
  `route_type` varchar(50) NOT NULL COMMENT '路线类型：RECOMMEND-推荐路线，THEME-主题路线，CUSTOM-自定义路线',
  `description` text COMMENT '路线描述',
  `estimated_duration` int COMMENT '预计时长(分钟)',
  `route_length` decimal(10,2) COMMENT '路线长度(米)',
 `map_file_id` bigint COMMENT '路线图文件ID',
  `cover_file_id` bigint COMMENT '封面图文件ID',
  `start_marker_id` bigint COMMENT '起点标注ID',
  `end_marker_id` bigint COMMENT '终点标注ID',
  `scenic_id` bigint COMMENT '关联景区ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `view_count` int NOT NULL DEFAULT 0 COMMENT '查看次数',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_scenic_id` (`scenic_id`),
  KEY `idx_route_type` (`route_type`),
  KEY `idx_sort_order` (`sort_order`),
  KEY `idx_status` (`status`),
 KEY `idx_map_file` (`map_file_id`),
  KEY `idx_cover_file` (`cover_file_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='参观路线表';
```

### 路线标注关联表
```sql
CREATE TABLE `route_marker` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '关联ID',
  `route_id` bigint NOT NULL COMMENT '路线ID',
  `marker_id` bigint NOT NULL COMMENT '标注ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_route_marker` (`route_id`, `marker_id`),
  KEY `idx_route_id` (`route_id`),
  KEY `idx_marker_id` (`marker_id`),
  KEY `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='路线标注关联表';

### 路线坐标点表
```sql
CREATE TABLE `route_point` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '坐标点ID',
  `route_id` bigint NOT NULL COMMENT '路线ID',
  `sort_order` int NOT NULL DEFAULT 0 COMMENT '排序顺序',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_route_id` (`route_id`),
  KEY `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='路线坐标点表';
```

## 知识库管理相关表

### 知识库表
```sql
CREATE TABLE `knowledge_base` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '知识库ID',
  `name` varchar(100) NOT NULL COMMENT '知识库名称',
  `description` text COMMENT '知识库描述',
  `category_id` bigint COMMENT '分类ID',
  `document_count` int NOT NULL DEFAULT 0 COMMENT '文档数量',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `creator_id` bigint COMMENT '创建人ID',
  `creator_name` varchar(100) COMMENT '创建人名称',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_category_id` (`category_id`),
  KEY `idx_status` (`status`),
  KEY `idx_creator_id` (`creator_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='知识库表';
```

### 知识文档表
```sql
CREATE TABLE `knowledge_document` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '文档ID',
  `title` varchar(200) NOT NULL COMMENT '文档标题',
  `content` text COMMENT '文档内容',
  `keywords` varchar(255) COMMENT '关键词',
  `knowledge_base_id` bigint NOT NULL COMMENT '知识库ID',
  `view_count` int NOT NULL DEFAULT 0 COMMENT '查看次数',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-草稿，1-已发布，2-已下线',
  `author_id` bigint COMMENT '作者ID',
  `author_name` varchar(100) COMMENT '作者名称',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_knowledge_base_id` (`knowledge_base_id`),
  KEY `idx_status` (`status`),
  KEY `idx_author_id` (`author_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='知识文档表';
```

### 文档附件表
```sql
CREATE TABLE `document_attachment` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '附件ID',
  `document_id` bigint NOT NULL COMMENT '文档ID',
  `file_id` bigint NOT NULL COMMENT '文件ID（关联resource_file表）',
  `thumbnail_file_id` bigint COMMENT '缩略图文件ID',
  `file_name` varchar(255) NOT NULL COMMENT '原始文件名',
  `file_size` bigint COMMENT '文件大小(字节)',
  `file_type` varchar(50) COMMENT '文件类型',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_document_id` (`document_id`),
 KEY `idx_file_id` (`file_id`),
  KEY `idx_file_type` (`file_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='文档附件表';
```

## 用户管理相关表

### 爽约记录表
```sql
CREATE TABLE `no_show_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `reservation_id` bigint NOT NULL COMMENT '预约ID',
  `reservation_type` tinyint NOT NULL COMMENT '预约类型：1-个人预约，2-团队预约，3-活动预约',
  `reservation_time` datetime NOT NULL COMMENT '预约时间',
  `record_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '记录时间',
  `operator_id` bigint COMMENT '操作人ID',
  `operator_name` varchar(50) COMMENT '操作人姓名',
  `remark` varchar(255) COMMENT '备注',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_reservation_id` (`reservation_id`),
  KEY `idx_reservation_type` (`reservation_type`),
  KEY `idx_record_time` (`record_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='爽约记录表';
```

### 黑名单记录表
```sql
CREATE TABLE `blacklist_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `action_type` tinyint NOT NULL COMMENT '操作类型：1-加入黑名单，2-移出黑名单',
  `reason` varchar(255) COMMENT '原因',
  `operator_id` bigint COMMENT '操作人ID',
  `operator_name` varchar(50) COMMENT '操作人姓名',
  `action_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
`create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_action_type` (`action_type`),
  KEY `idx_action_time` (`action_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='黑名单记录表';
```

## 权限相关表

### 权限表
```sql
CREATE TABLE `permission` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '权限ID',
  `permission_code` varchar(100) NOT NULL COMMENT '权限编码',
  `permission_name` varchar(100) NOT NULL COMMENT '权限名称',
  `permission_desc` varchar(255) COMMENT '权限描述',
  `resource_type` varchar(50) NOT NULL COMMENT '资源类型：MENU-菜单，BUTTON-按钮，API-接口',
  `resource_path` varchar(255) COMMENT '资源路径',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_permission_code` (`permission_code`),
  KEY `idx_resource_type` (`resource_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='权限表';
```

### 操作员权限表
```sql
CREATE TABLE `operator_permission` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '关联ID',
  `operator_id` bigint NOT NULL COMMENT '操作员ID',
  `permission_id` bigint NOT NULL COMMENT '权限ID',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_operator_permission` (`operator_id`, `permission_id`),
  KEY `idx_operator_id` (`operator_id`),
  KEY `idx_permission_id` (`permission_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='操作员权限表';
```

## 通知管理相关表

### 通知模板表
```sql
CREATE TABLE `notification_template` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '模板ID',
  `template_code` varchar(50) NOT NULL COMMENT '模板编码',
  `template_name` varchar(100) NOT NULL COMMENT '模板名称',
  `template_content` text NOT NULL COMMENT '模板内容',
  `notification_type` tinyint NOT NULL COMMENT '通知类型：1-短信，2-邮件，3-站内信，4-微信',
  `status` tinyint NOT NULL DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_template_code` (`template_code`),
  KEY `idx_notification_type` (`notification_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='通知模板表';
```

### 通知记录表
```sql
CREATE TABLE `notification_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',
  `template_id` bigint NOT NULL COMMENT '模板ID',
  `channel_id` bigint NOT NULL COMMENT '渠道ID',
  `recipient` varchar(255) NOT NULL COMMENT '接收人',
  `subject` varchar(255) COMMENT '主题',
  `content` text NOT NULL COMMENT '内容',
  `send_status` tinyint NOT NULL DEFAULT 0 COMMENT '发送状态：0-待发送，1-发送成功，2-发送失败',
  `send_time` datetime COMMENT '发送时间',
  `retry_count` int NOT NULL DEFAULT 0 COMMENT '重试次数',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  KEY `idx_template_id` (`template_id`),
  KEY `idx_channel_id` (`channel_id`),
  KEY `idx_send_status` (`send_status`),
  KEY `idx_send_time` (`send_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='通知记录表';
```

### 通知设置表
```sql
CREATE TABLE `notification_setting` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '设置ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `notification_type` tinyint NOT NULL COMMENT '通知类型：1-预约成功，2-预约取消，3-验证提醒，4-系统通知',
  `channel_type` tinyint NOT NULL COMMENT '渠道类型：1-短信，2-邮件，3-站内信，4-微信',
  `is_enabled` tinyint NOT NULL DEFAULT 1 COMMENT '是否启用：0-禁用，1-启用',
  `version` int NOT NULL DEFAULT 0 COMMENT '版本号（乐观锁）',
 `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
 `create_by` bigint COMMENT '创建人',
  `update_by` bigint COMMENT '更新人',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_notification_channel` (`user_id`, `notification_type`, `channel_type`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_is_enabled` (`is_enabled`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='通知设置表';
```
